
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.37">
    
    
      
        <title>eDNA Metabarcoding for COI target region - GMGI Fisheries Handbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#edna-metabarcoding-for-coi-target-region" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="GMGI Fisheries Handbook" class="md-header__button md-logo" aria-label="GMGI Fisheries Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GMGI Fisheries Handbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              eDNA Metabarcoding for COI target region
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GMGI-Fisheries/resources" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="GMGI Fisheries Handbook" class="md-nav__button md-logo" aria-label="GMGI Fisheries Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GMGI Fisheries Handbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GMGI-Fisheries/resources" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computing Hardware
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Computing Hardware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Computing_GMGI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GMGI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Computing_NU/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Northeastern University
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data_Management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Management
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data_To_Server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Transfer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computing Beginner Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Computing Beginner Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Computing_Begin_Resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Visualization%20in%20R/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tbd.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Github
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tbd.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to HPC
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: 12S metabarcoding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            eDNA: 12S metabarcoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-creating_eDNA_conda_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00-Create-conda-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/01-Metabarcoding%20ampliseq%2012S%20Riaz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-ampliseq-12S
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/02-datatable_prep_12S_Riaz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02-dfprep-12S
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/03-data_quality/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03-data-quality
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/04-relative_abundance_heatmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04-relative-abund-heatmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/05-biodiversity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05-biodiversity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: COI metabarcoding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            eDNA: COI metabarcoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-creating_eDNA_conda_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00-Create-conda-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-Metabarcoding%20ampliseq%20COI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-ampliseq-COI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: qPCR
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            eDNA: qPCR
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%20qPCR/qPCR-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-dfprep-analysis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Population Genomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Population Genomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PopGen/eDNA_01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coming soon!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Epigenetic Aging
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Epigenetic Aging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EpiAge/eDNA_01.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coming soon!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Genome Assembly
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Genome Assembly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tbd.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coming soon!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#primer-set" class="md-nav__link">
    <span class="md-ellipsis">
      Primer set
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Workflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-confirm-conda-environment-is-available" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Confirm conda environment is available
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-assess-quality-of-raw-data" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Assess quality of raw data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-visualize-quality-of-raw-data" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Visualize quality of raw data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-set-up-mothur-program" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Set-up Mothur program
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Set-up Mothur program">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-primer-file" class="md-nav__link">
    <span class="md-ellipsis">
      Create primer file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mothur-program-set-up-project" class="md-nav__link">
    <span class="md-ellipsis">
      Mothur program set-up project
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assess-output-data-from-osw-example" class="md-nav__link">
    <span class="md-ellipsis">
      Assess output (data from OSW example):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-qcing-seqs-via-mothur" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: QC'ing seqs via Mothur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-determining-and-counting-unique-sequences-with-mothur" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Determining and counting unique sequences with Mothur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-taxonomic-assignment-with-mothur" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7: Taxonomic Assignment with Mothur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-qc-taxonomic-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      Step 8: QC Taxonomic Alignment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-9-denoise-and-remove-chimeras" class="md-nav__link">
    <span class="md-ellipsis">
      Step 9: Denoise and remove chimeras
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 9: Denoise and remove chimeras">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#denoising" class="md-nav__link">
    <span class="md-ellipsis">
      Denoising
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-chimeras" class="md-nav__link">
    <span class="md-ellipsis">
      Removing chimeras
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-10-classify-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      Step 10: Classify sequences
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/GMGI-Fisheries/resources/blob/master/docs/eDNA COI metab/01-Metabarcoding Mothur COI.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="edna-metabarcoding-for-coi-target-region">eDNA Metabarcoding for COI target region</h1>
<h3 id="primer-set">Primer set</h3>
<p>The COI region is commonly used for metabarcoding practices and consequently there are many primer options to choose from. The Fisheries team at GMGI has optimized the Leray Geller set (outlined in red box below). Citation: <a href="https://link.springer.com/article/10.1186/1742-9994-10-34">Leray et al 2013</a>.</p>
<p>We primarily use this set for invertebrate targets and 12S for vertebrate communities. </p>
<p><img alt="" src="https://github.com/GMGI-Fisheries/resources/blob/master/img/eDNA_meta_COI_primerset.png?raw=true" /></p>
<h3 id="workflow">Workflow</h3>
<p><a href="https://mothur.org/">Mothur program page</a></p>
<p><img alt="" src="https://github.com/GMGI-Fisheries/resources/blob/master/img/eDNA_meta_COI_workflow.png?raw=true" /></p>
<p>Workflow done on HPC. Scripts to run: </p>
<ol>
<li>Confirm conda environment is available      </li>
<li>Assess quality of raw data (00-fastqc.sh)        </li>
<li>Visualize quality of raw data (00-multiqc.sh)     </li>
<li>Set-up Mothur program (01-Mothur-setup.sh)  </li>
<li>QC'ing seqs via Mothur (02-Mothur-QC.sh)      </li>
<li>Determining and counting unique sequences with Mothur (03-Mothur-unique.sh)   </li>
<li>Taxonomic Assignment with Mothur (04-Mothur-tax.sh)  </li>
</ol>
<p><em>Descriptions of Mothur steps are from <a href="https://github.com/AHuffmyer/ASH_Putnam_Lab_Notebook/blob/master/_posts/2022-01-12-16S-Analysis-in-Mothr-Part-1.md#makecontigs">A. Huffmyer</a> and <a href="https://github.com/emmastrand/EmmaStrand_Notebook/blob/master/_posts/2022-01-24-KBay-Bleached-Pairs-16S-Analysis-Mothur.md">E. Strand</a> Mothur for 16S notebook posts.</em> </p>
<h2 id="step-1-confirm-conda-environment-is-available">Step 1: Confirm conda environment is available</h2>
<p>The conda environment is started within each slurm script, but to activate conda environment outside of the slurm script to update packages or check what is installed:</p>
<div class="highlight"><pre><span></span><code># Activate conda
source /work/gmgi/miniconda3/bin/activate

# Activate fisheries eDNA conda environment 
conda activate fisheries_eDNA
conda activate eDNA_COI

# List all available environments 
conda env list 

# List all packages installed in fisheries_eDNA
conda list 

# Update a package
conda update [package name]
</code></pre></div>
<h2 id="step-2-assess-quality-of-raw-data">Step 2: Assess quality of raw data</h2>
<p>Background information on <a href="https://hbctraining.github.io/Intro-to-rnaseq-hpc-salmon-flipped/lessons/05_qc_running_fastqc_interactively.html">FASTQC</a>. </p>
<p><code>00-fastqc.sh</code>: </p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/fastqc_output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/fastqc_output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=20:00:00
#SBATCH --job-name=fastqc
#SBATCH --mem=3GB
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=2

### USER TO-DO ### 
## 1. Set paths for your project

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate fisheries_eDNA

## SET PATHS 
raw_path=$1
out_dir=$2

## CREATE SAMPLE LIST FOR SLURM ARRAY
### 1. Create list of all .gz files in raw data path
ls -d ${raw_path}/*.gz &gt; ${raw_path}/rawdata

### 2. Create a list of filenames based on that list created in step 1
mapfile -t FILENAMES &lt; ${raw_path}/rawdata

### 3. Create variable i that will assign each row of FILENAMES to a task ID
i=${FILENAMES[$SLURM_ARRAY_TASK_ID - 1]}

## RUN FASTQC PROGRAM 
fastqc ${i} --outdir ${out_dir}
</code></pre></div>
<p>To run:  <br />
- Start slurm array (e.g., with 138 files) = <code>sbatch --array=1-138 /work/gmgi/scripts/00-fastqc.sh /path/to/raw/data /path/to/output/directory</code>.</p>
<p>Notes:  </p>
<ul>
<li>This is going to output <em>many</em> error and output files. After job completes, use <code>cat *output.* &gt; ../fastqc_output.txt</code> to create one file with all the output and <code>cat *error.* &gt; ../fastqc_error.txt</code> to create one file with all of the error message outputs. </li>
<li>Within the <code>out_dir</code> output folder, use <code>ls *html | wc</code> to count the number of html output files (1st/2nd column values). This should be equal to the --array range used and the number of raw data files. If not, the script missed some input files so address this before moving on.  </li>
</ul>
<h2 id="step-3-visualize-quality-of-raw-data">Step 3: Visualize quality of raw data</h2>
<p>Background information on <a href="https://multiqc.info/docs/#:~:text=MultiQC%20is%20a%20reporting%20tool%20that%20parses%20results,experiments%20containing%20multiple%20samples%20and%20multiple%20analysis%20steps">MULTIQC</a>.</p>
<p><code>00-multiqc.sh</code> </p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=10:00:00
#SBATCH --job-name=multiqc
#SBATCH --mem=8GB
#SBATCH --ntasks=24
#SBATCH --cpus-per-task=2

### USER TO-DO ### 
## 1. Set paths for your project
## 2. Optional: change file name (multiqc_raw.html) as desired

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate fisheries_eDNA

## SET PATHS 
## fastqc_output = output from 00-fastqc.sh; fastqc program
fastqc_output=$1
multiqc_dir=$2
filename=$3

## RUN MULTIQC 
multiqc --interactive ${fastqc_output} -o ${multiqc_dir} --filename multiqc_${filename}.html
</code></pre></div>
<p>To run:<br />
- Navigate to fastqc output and run <code>sbatch /work/gmgi/scripts/00-multiqc.sh /path/to/fastqc/data /path/to/multiqc/output/directory filename</code> </p>
<p>Notes:  </p>
<ul>
<li>Depending on the number of files per project, multiqc can be quick to run without a slurm script. To do this, run each line separately in the command line after activating the conda environment.  </li>
</ul>
<h2 id="step-4-set-up-mothur-program">Step 4: Set-up Mothur program</h2>
<h4 id="create-primer-file">Create primer file</h4>
<p>Project set-up create primer seq file, <strong>only needed once, if file is already there do not create a new one</strong>:<br />
1. Navigate to COI databases folder: <code>cd /work/gmgi/databases/COI</code><br />
2. Create new file for Leray Gellar primer set: <code>nano mothur_oligos_LG</code><br />
3. Copy and paste the below content:</p>
<div class="highlight"><pre><span></span><code>## Leray Geller 2013 primers 
## format = primer F R

primer GGWACWGGWTGAACWGTWTAYCCYCC TAIACYTCIGGRTGICCRAARAAYCA
</code></pre></div>
<h4 id="mothur-program-set-up-project">Mothur program set-up project</h4>
<p>Create directory: <code>mkdir Mothur_data</code></p>
<p><code>make.file()</code>: tells mothur to look for fastq files in the data directory (<code>rawdata_dir</code>) and identify forward and reverse reads. Put type=gz to look for gz files. If there are .fasta or .fastq files you can use type=fasta or type=fastq. The prefix gives the output file a name - this can be a project name. This creates a file called proj_name.files with sample name, R1, R2 listed in columns.<br />
- Output: <code>proj.paired.files</code> within the <code>rawdata_dir</code>  </p>
<p><code>make.contigs()</code>: makes contigs of forward and reverse reads for each sample. This will assemble contigs for each pair of files and use R1 and R2 quality information to correct any sequencing errors in locations where there is overlap and the quality of the complementary sequence is sufficient. Because we added an oligos file, make.contigs will remove the primers on these sequences. <br />
- <code>pdiffs=5</code>: primer differences=5. Try various parameters from 2-10 (based on other pipeline I've used or seen in the past).<br />
- <code>checkorient=t</code>: Degenerate primers can be used in our oligos file. We are also using check orient to allow Mothur to "flip" the reverse primer if it is not found.<br />
- <code>trimoverlap=F</code>: TRUE is needed if sequencing length was longer than amplicon length. The COI region is 313 bp which is longer than 2x250 bp sequencing.  </p>
<p><code>summary.seqs()</code>: generates summary information about the sequences from the files we made above.</p>
<p>Run time: ~30-45 min for 30-40 files (from previous project; update values with GMGI COI info)</p>
<p><code>01-Mothur-setup.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=10:00:00
#SBATCH --job-name=mothur_setup
#SBATCH --mem=10GB
#SBATCH --ntasks=3
#SBATCH --cpus-per-task=3

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate eDNA_COI

# Set Paths 
oligo_file=&quot;/work/gmgi/databases/COI/mothur_oligos_LG&quot;

## User specific paths
#rawdata_dir=&quot;/work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/raw_data&quot;
#proj_name=&quot;OSW_2023_invert&quot; 
#output_dir=&quot;/work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/Mothur_data&quot;

rawdata_dir=$1
output_dir=$2
proj_name=$3

## Make symlinks from raw data with new name (_ instead of -)
for file in ${rawdata_dir}/*.gz; do
    filename=$(basename &quot;$file&quot;)
    newname=${filename//-/_}
    ln -s &quot;$file&quot; &quot;${output_dir}/${newname}&quot;
done

cd ${output_dir} 

## Make file with raw fastq files
mothur &quot;#make.file(inputdir=., type=gz, prefix=${proj_name})&quot;   

## Make contig file 
mothur &quot;#make.contigs(inputdir=., outputdir=., file=${proj_name}.paired.files, trimoverlap=F, oligos=${oligo_file}, pdiffs=5, checkorient=T)&quot;

## Create a summary file with trimmed contigs 
mothur &quot;#summary.seqs(fasta=${proj_name}.paired.trim.contigs.fasta)&quot;
</code></pre></div>
<p>To run: <code>sbatch /work/gmgi/scripts/eDNA/COI/Mothur/01-Mothur-setup.sh /path/to/raw/data /path/to/output/directory project_prefix</code>  </p>
<p>Example: </p>
<div class="highlight"><pre><span></span><code>sbatch /work/gmgi/scripts/eDNA/COI/Mothur/01-Mothur-setup.sh \
    /work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/raw_data \
    /work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/Mothur_data \
    OSW_2023_invert
</code></pre></div>
<h4 id="assess-output-data-from-osw-example">Assess output (data from OSW example):</h4>
<p>Count the number of sequences that were removed and the number that were kept by counting sequences in each fasta file</p>
<div class="highlight"><pre><span></span><code>proj_name=&quot;OSW_2023_invert&quot;
grep -c &quot;^&gt;&quot; ${proj_name}.paired.trim.contigs.fasta
## output = 10,272,910

grep -c &quot;^&gt;&quot; ${proj_name}.paired.scrap.contigs.fasta 
## output = 3,033,941
</code></pre></div>
<p>The logfiles will be named with the run ID so I used <code>mv</code> to change these to names that reflect the step:<br />
- <code>mothur.01setup.makecontigs.logfile</code><br />
- <code>mothur.01setup.summary.contigs.logfile</code>  </p>
<p>Summary of OSW data from <code>mothur.01setup.summary.contigs.logfile</code>: </p>
<div class="highlight"><pre><span></span><code>                Start   End     NBases  Ambigs  Polymer NumSeqs
Minimum:        1       124     124     0       3       1
2.5%-tile:      1       251     251     0       4       256823
25%-tile:       1       365     365     0       5       2568228
Median:         1       365     365     0       6       5136456
75%-tile:       1       365     365     1       6       7704683
97.5%-tile:     1       404     404     8       8       10016088
Maximum:        1       502     502     191     233     10272910
Mean:   1       363     363     1       5
# of Seqs:      10272910
It took 193 secs to summarize 10272910 sequences.
</code></pre></div>
<p>This table shows quantile values about the distribution of sequences for a few things: <br />
- Start position: All at 1 now, will start at different point after some QC.<br />
- End position: We see that there are some sequences that are very short and we may need to remove those later.<br />
- Number of bases: length. we see most are in expected range here, but one is super long! This might tell us there is no overlap so they are butted up against each other. We will remove things like this.<br />
- Ambigs: Number of ambiguous calls in sequences. Here there are a few that have ambiguous base calls. We will remove any sequence with an ambiguous call or any longer than we would expect for COI region.<br />
- Polymer: Length of polymer repeats.<br />
- NumSeqs: Number of sequences.  </p>
<p>Output:  <br />
- proj_name.contigs.groups               <br />
- proj_name.contigs.report                                      <br />
- proj_name.scrap.contigs.fasta          <br />
- proj_name.trim.contigs.fasta <br />
- proj_name.trim.contigs.summary  </p>
<p>Descriptions of contig files: <br />
- Trim file = sequences that were "good".<br />
- Scrap file = sequences that were "bad".<br />
- Groups file = what group each sequence belongs to map sequence to each sample from the trimmed sequence file.<br />
- Contigs report file = information on sequences that were aligned and paired together.  </p>
<h2 id="step-5-qcing-seqs-via-mothur">Step 5: QC'ing seqs via Mothur</h2>
<p>Additional QC steps besides removing primers. </p>
<p>Check the 25%-tile, median, and 75%-tile values from the table above. That will determine the max cut-offs below along with the expected length of the COI region (~313 bp but in OSW data, the majority are &gt;350 bp). </p>
<p><code>screen.seqs()</code>: specify the fasta file of the contigs generated in the previous step and remove any sequence with an ambiguous call ("N"). We will also remove sequences &gt;350 nt. We will also set a minimum size amount (200). These parameters could be adjusted based on specific experiment and variable region.</p>
<p><code>02-Mothur-QC.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=10:00:00
#SBATCH --job-name=mothur_QC
#SBATCH --mem=10GB
#SBATCH --ntasks=6
#SBATCH --cpus-per-task=2

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate eDNA_COI

dir=$1
proj_name=$2

cd ${dir}

mothur &quot;#screen.seqs(inputdir=., outputdir=., fasta=${proj_name}.paired.trim.contigs.fasta, group=${proj_name}.paired.contigs.groups, maxambig=0, maxlength=400, minlength=200)&quot;

mothur &quot;#summary.seqs(fasta=${proj_name}.paired.trim.contigs.good.fasta)&quot;
</code></pre></div>
<p>To run: <code>sbatch /work/gmgi/scripts/eDNA/COI/Mothur/02-Mothur-QC.sh /path/to/output/directory project_prefix</code>  </p>
<p>Example: </p>
<p>Running OSW from invertebrate/scripts folder </p>
<div class="highlight"><pre><span></span><code>sbatch 02-Mothur-QC.sh \
    /work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/Mothur_data \
    OSW_2023_invert
</code></pre></div>
<p>Output files:  <br />
- proj_name.trim.contigs.good.fasta <br />
- proj_name.trim.contigs.bad.accnos  <br />
- proj_name.contigs.good.groups  </p>
<p>OSW example: Removed 3,596,140 sequences that fall outside of 200-400 bp length bin with no ambiguous calls so 6,676,770 remaining sequences. </p>
<div class="highlight"><pre><span></span><code>                Start   End     NBases  Ambigs  Polymer NumSeqs
Minimum:        1       213     213     0       3       1
2.5%-tile:      1       251     251     0       4       166920
25%-tile:       1       365     365     0       5       1669193
Median:         1       365     365     0       6       3338386
75%-tile:       1       365     365     0       6       5007578
97.5%-tile:     1       368     368     0       7       6509851
Maximum:        1       400     400     0       105     6676770
Mean:   1       360     360     0       5
# of Seqs:      6676770
</code></pre></div>
<p>Changed the name of the log files to:  <br />
- mothur.02contigQC.screenseqs.logfile    <br />
- mothur.02contigQC.summary.logfile   </p>
<h2 id="step-6-determining-and-counting-unique-sequences-with-mothur">Step 6: Determining and counting unique sequences with Mothur</h2>
<p>Identifying unique sequences and counting those. </p>
<p><code>03-Mothur-unique.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=10:00:00
#SBATCH --job-name=mothur_uniq
#SBATCH --mem=5GB
#SBATCH --ntasks=6
#SBATCH --cpus-per-task=2

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate eDNA_COI

dir=&quot;/work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/Mothur_data&quot;
proj_name=&quot;OSW_2023_invert&quot; 

cd ${dir}

mothur &quot;#unique.seqs(fasta=${proj_name}.paired.trim.contigs.good.fasta)&quot;

mothur &quot;#count.seqs(name=${proj_name}.paired.trim.contigs.good.names, group=${proj_name}.paired.contigs.good.groups)&quot;

mothur &quot;#summary.seqs(fasta=${proj_name}.paired.trim.contigs.good.unique.fasta, count=${proj_name}.paired.trim.contigs.good.count_table)&quot;
</code></pre></div>
<p>OSW example output: </p>
<div class="highlight"><pre><span></span><code>                Start   End     NBases  Ambigs  Polymer NumSeqs
Minimum:        1       213     213     0       3       1
2.5%-tile:      1       251     251     0       4       166920
25%-tile:       1       365     365     0       5       1669193
Median:         1       365     365     0       6       3338386
75%-tile:       1       365     365     0       6       5007578
97.5%-tile:     1       368     368     0       7       6509851
Maximum:        1       400     400     0       105     6676770
Mean:   1       360     360     0       5
# of unique seqs:       3138754
total # of seqs:        6676770
</code></pre></div>
<p>There are 3,138,754 unique sequences in this OSW example dataset. </p>
<p>Changing the log file names to:<br />
- mothur.03unique.uniqueseqs.logfile<br />
- mothur.03unique.countseqs.logfile  <br />
- mothur.03unique.summary.logfile  </p>
<h2 id="step-7-taxonomic-assignment-with-mothur">Step 7: Taxonomic Assignment with Mothur</h2>
<p>Using MetaZooGene Global database as reference. This database has sequences from both BOLD and NCBI GenBank. </p>
<p>https://metazoogene.org/mzgdb/. Navigate to the <a href="https://www.st.nmfs.noaa.gov/copepod/collaboration/metazoogene/atlas/index-o00.html">Worlds oceans</a> page and click MZGdb Data Access page. We have downloaded both the Global and North Atlantic versions.   </p>
<p>Download and update database:</p>
<div class="highlight"><pre><span></span><code>cd /work/gmgi/databases/COI/MetaZooGene

## Global 
wget https://www.st.nmfs.noaa.gov/copepod/collaboration/metazoogene/atlas/data-src/MZGfasta-coi__T4000000__o00__A.fasta.gz
wget https://www.st.nmfs.noaa.gov/copepod/collaboration/metazoogene/atlas/data-src/MZGmothur-coi__T4000000__o00__A.txt.gz

## North Atlantic 
wget https://www.st.nmfs.noaa.gov/copepod/collaboration/metazoogene/atlas/data-src/MZGfasta-coi__T4000000__o02__A.fasta.gz
wget https://www.st.nmfs.noaa.gov/copepod/collaboration/metazoogene/atlas/data-src/MZGmothur-coi__T4000000__o02__A.txt.gz

## unzip into new name file 
## replace with version number 
gunzip -c MZGfasta-coi__T4000000__o00__A.fasta.gz &gt; MZG_v2023-m07-15_Global_modeA.fasta
gunzip -c MZGfasta-coi__T4000000__o02__A.fasta.gz &gt; MZG_v2023-m07-15_NorthAtlantic_modeA.fasta
gunzip -c MZGmothur-coi__T4000000__o02__A.txt.gz &gt; MZG_v2023-m07-15-NorthAtlantic_modeA.txt
gunzip -c MZGmothur-coi__T4000000__o00__A.txt.gz &gt; MZG_v2023-m07-15-Global_modeA.txt
</code></pre></div>
<p>Align the database prior to using as input in Mothur:</p>
<p><code>MZG_align.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=10:00:00
#SBATCH --job-name=MZG_MAFFT
#SBATCH --mem=50GB
#SBATCH --ntasks=24
#SBATCH --cpus-per-task=2

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate eDNA_COI

### changing name format to MAFFT_xxx_aligned.fasta 

# Assign input and output file names from command-line arguments
INPUT_FILE=$1
OUTPUT_FILE=$2

# Run MAFFT with the provided input and output files
mafft --auto &quot;$INPUT_FILE&quot; &gt; &quot;$OUTPUT_FILE&quot;
</code></pre></div>
<p>Use format: <code>sbatch MZG_align.sh input output</code>  <br />
Example: <code>sbatch MZG_align.sh MZG_v2023-m07-15_NorthAtlantic_modeA.fasta MAFFT_MZG_v2023-m07-15_NorthAtlantic_modeA_aligned.fasta</code>   <br />
<code>sbatch MZG_align.sh MZG_v2023-m07-15_Global_modeA.fasta MAFFT_MZG_v2023-m07-15_Global_modeA_aligned.fasta</code> </p>
<p>Running taxonomic assignment via Mothur: </p>
<p><code>04-Mothur-tax.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=24:00:00
#SBATCH --job-name=mothur_tax
#SBATCH --mem=20GB
#SBATCH --ntasks=12
#SBATCH --cpus-per-task=2

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate eDNA_COI

dir=&quot;/work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/Mothur_data&quot;
proj_name=&quot;OSW_2023_invert&quot; 
#ref=&quot;/work/gmgi/databases/COI/MetaZooGene/MAFFT_MZG_v2023-m07-15_NorthAtlantic_modeA_aligned.fasta&quot;
ref=&quot;/work/gmgi/databases/COI/MetaZooGene/MAFFT_MZG_v2023-m07-15_Global_modeA_aligned.fasta&quot;

cd ${dir}

mothur &quot;#align.seqs(fasta=${proj_name}.paired.trim.contigs.good.unique.fasta, reference=${ref}, flip=T, processors=48)&quot;
mothur &quot;#summary.seqs(fasta=${proj_name}.paired.trim.contigs.good.unique.align)&quot;
</code></pre></div>
<p>Atlantic comparison:</p>
<div class="highlight"><pre><span></span><code>                Start   End     NBases  Ambigs  Polymer NumSeqs
Minimum:        0       0       0       0       1       1
2.5%-tile:      1836    7145    5       0       1       78469
25%-tile:       6781    7145    365     0       5       784689
Median:         22391   24785   365     0       6       1569378
75%-tile:       22508   25827   365     0       6       2354066
97.5%-tile:     93935   93943   368     0       7       3060286
Maximum:        121316  121316  400     0       26      3138754
Mean:   20928   28519   337     0       5
# of Seqs:      3138754
</code></pre></div>
<p>World comparison</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h2 id="step-8-qc-taxonomic-alignment">Step 8: QC Taxonomic Alignment</h2>
<p><code>05-Mothur-taxQC.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=10:00:00
#SBATCH --job-name=mothur_taxQC
#SBATCH --mem=50GB
#SBATCH --ntasks=6
#SBATCH --cpus-per-task=2

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate eDNA_COI

dir=&quot;/work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/Mothur_data&quot;
proj_name=&quot;OSW_2023_invert&quot; 

cd ${dir}

## Identifying those that don&#39;t meet the criteria 
mothur &quot;#screen.seqs(fasta=${proj_name}.paired.trim.contigs.good.unique.align, count=${proj_name}.paired.trim.contigs.good.count_table, optimize=start, criteria=90, maxhomop=8)&quot;
mothur &quot;#summary.seqs(fasta=current, count=current)&quot;
mothur &quot;#count.groups(count=${proj_name}.paired.trim.contigs.good.count_table)&quot;

## Filtering those out
mothur &quot;#filter.seqs(fasta=${proj_name}.paired.trim.contigs.good.unique.good.align, vertical=T, trump=.)&quot;
mothur &quot;#summary.seqs(fasta=current, count=current)&quot;

## ID unique sequences again
mothur &quot;#unique.seqs(fasta=${proj_name}.paired.trim.contigs.good.unique.good.filter.fasta, count=${proj_name}.paired.trim.contigs.good.good.count_table)&quot;
</code></pre></div>
<h2 id="step-9-denoise-and-remove-chimeras">Step 9: Denoise and remove chimeras</h2>
<h4 id="denoising">Denoising</h4>
<p>Now we need to further polish and cluster the data with pre.cluster. The purpose of this step is to remove noise due to sequencing error. The rational behind this step assumes that the most abundant sequences are the most trustworthy and likely do not have sequencing errors. Pre-clustering then looks at the relationship between abundant and rare sequences - rare sequences that are "close" (e.g., 1 nt difference) to highly abundant sequences are likely due to sequencing error. This step will pool sequences and look at the maximum differences between sequences within this group to form ASV groupings.</p>
<p>In this step, the number of sequences is not reduced, but they are grouped into amplicon sequence variants ASV's which reduces the error rate. </p>
<p>Other programs that conduct this "denoising" are DADA2, UNOISE, and DEBLUR. However, these programs remove the rare sequences, which can distort the relative abundance of remaining sequences. DADA2 also removes all sigletons (sequences with single representation) which disproportionately affects the sequence relative abundance. Mothur avoids the removal of rare sequences for this reason.</p>
<h4 id="removing-chimeras">Removing chimeras</h4>
<p>At this point we have removed as much sequencing error as we can and it is time to turn our attention to removing chimeras. We'll do this using the VSEARCH algorithm that is called within mothur using the chimera.vsearch command. </p>
<p><code>06-Mothur-denoise.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=10:00:00
#SBATCH --job-name=mothur_denoise
#SBATCH --mem=20GB
#SBATCH --ntasks=6
#SBATCH --cpus-per-task=2

# Activate conda environment
source /work/gmgi/miniconda3/bin/activate eDNA_COI

dir=&quot;/work/gmgi/Fisheries/eDNA/offshore_wind/invertebrate/Mothur_data&quot;
proj_name=&quot;OSW_2023_invert&quot; 

cd ${dir}

## Denoise 
mothur &quot;#pre.cluster(fasta=${proj_name}.paired.trim.contigs.good.unique.good.filter.unique.fasta, count=${proj_name}.paired.trim.contigs.good.unique.good.filter.count_table, diffs=1, method=unoise)&quot;

## Remove chimeras 
mothur &quot;#chimera.vsearch(fasta=current, count=current, dereplicate=t)&quot;
mothur &quot;#remove.seqs(fasta=current, accnos=current)&quot;

## Produce summary file 
mothur &quot;#summary.seqs(fasta=current, count=current, log=%x.${proj_name}.summarypostfilter.log)&quot;
</code></pre></div>
<p>Stuck here b/c steps are removing almost all reads from samples.. why </p>
<h2 id="step-10-classify-sequences">Step 10: Classify sequences</h2>
<p>Fasta reference file:<br />
Taxonomy file:  </p>
<p><code>.sh</code></p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
    
  </body>
</html>