
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../00-creating_eDNA_conda_env/">
      
      
        <link rel="next" href="../../eDNA%20qPCR/qPCR-analysis-template/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.37">
    
    
      
        <title>01-ampliseq-18S - GMGI Fisheries Handbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metabarcoding-workflow-for-18s-amplicon-sequencing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="GMGI Fisheries Handbook" class="md-header__button md-logo" aria-label="GMGI Fisheries Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GMGI Fisheries Handbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              01-ampliseq-18S
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GMGI-Fisheries/resources" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="GMGI Fisheries Handbook" class="md-nav__button md-logo" aria-label="GMGI Fisheries Handbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GMGI Fisheries Handbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GMGI-Fisheries/resources" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computing Hardware
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Computing Hardware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Computing_GMGI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GMGI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Computing_NU/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Northeastern University
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data_Management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Management
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data_To_Server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Transfer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Computing Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Computing Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Computing_Begin_Resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Data%20Visualization%20in%20R/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tbd.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Github
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Introduction%20to%20HPC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to HPC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Conda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Introduction%20to%20Containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Containers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Introduction%20to%20Workflow%20Managers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Workflow Managers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: 12S metabarcoding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            eDNA: 12S metabarcoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-creating_eDNA_conda_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00-Create-conda-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/01-Metabarcoding%20ampliseq_12S_Riaz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-ampliseq-12S
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/02-outlier_detection-template-12S/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02-outlier-12S
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/03-tax_assignment-template-12S/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03-tax_assign-12S
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/04-report_generation-template-12S/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04-report_generation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/05-heatmap-template-12S/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05-heatmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2012S%20metab/06-phyloseq-template-12S/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06-phyloseq
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: COI metabarcoding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            eDNA: COI metabarcoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-creating_eDNA_conda_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00-Create-conda-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%20COI%20metab/01-Metabarcoding%20ampliseq%20COI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-ampliseq-COI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: 16S metabarcoding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            eDNA: 16S metabarcoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-creating_eDNA_conda_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00-Create-conda-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%2016S%20metab/01-Metabarcoding%20ampliseq%2016S/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-ampliseq-16S
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: 18S metabarcoding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            eDNA: 18S metabarcoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-creating_eDNA_conda_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00-Create-conda-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    01-ampliseq-18S
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    01-ampliseq-18S
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#project-set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Project set-up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#confirm-conda-environment-is-available" class="md-nav__link">
    <span class="md-ellipsis">
      Confirm conda environment is available
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assess-quality-of-raw-data" class="md-nav__link">
    <span class="md-ellipsis">
      Assess quality of raw data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assess quality of raw data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualize-quality-of-raw-data" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize quality of raw data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identify-sequencing-outliers-and-sub-sample-if-needed" class="md-nav__link">
    <span class="md-ellipsis">
      Identify sequencing outliers and sub-sample if needed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Identify sequencing outliers and sub-sample if needed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-seqtk-program" class="md-nav__link">
    <span class="md-ellipsis">
      Download seqtk program
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-seqtk-with-a-single-or-handful-of-samples" class="md-nav__link">
    <span class="md-ellipsis">
      Running seqtk with a single (or handful) of samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-seqtk-with-a-list-of-files" class="md-nav__link">
    <span class="md-ellipsis">
      Running seqtk with a list of files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloading-and-updating-reference-databases" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading and updating reference databases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Downloading and updating reference databases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-andor-update-pr2-database" class="md-nav__link">
    <span class="md-ellipsis">
      Download and/or update pr2 database
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-nf-coreampliseq" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: nf-core/ampliseq
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: nf-core/ampliseq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#18s-primer-sequences-required" class="md-nav__link">
    <span class="md-ellipsis">
      18S primer sequences (required)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata-sheet-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata sheet (optional)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-samplesheet-sheet-for-ampliseq" class="md-nav__link">
    <span class="md-ellipsis">
      Create samplesheet sheet for ampliseq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-nf-coreampliseq-cutadapt-dada2" class="md-nav__link">
    <span class="md-ellipsis">
      Run nf-core/ampliseq (Cutadapt &amp; DADA2)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run nf-core/ampliseq (Cutadapt & DADA2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files-generated-by-ampliseq" class="md-nav__link">
    <span class="md-ellipsis">
      Files generated by ampliseq
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    eDNA: qPCR
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            eDNA: qPCR
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../eDNA%20qPCR/qPCR-analysis-template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-dfprep-analysis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Population Genomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Population Genomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PopGen/eDNA_01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coming soon!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Epigenetic Aging
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Epigenetic Aging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../EpiAge/eDNA_01.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coming soon!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Genome Assembly
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Genome Assembly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tbd.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coming soon!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#project-set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Project set-up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#confirm-conda-environment-is-available" class="md-nav__link">
    <span class="md-ellipsis">
      Confirm conda environment is available
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assess-quality-of-raw-data" class="md-nav__link">
    <span class="md-ellipsis">
      Assess quality of raw data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assess quality of raw data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualize-quality-of-raw-data" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize quality of raw data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identify-sequencing-outliers-and-sub-sample-if-needed" class="md-nav__link">
    <span class="md-ellipsis">
      Identify sequencing outliers and sub-sample if needed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Identify sequencing outliers and sub-sample if needed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-seqtk-program" class="md-nav__link">
    <span class="md-ellipsis">
      Download seqtk program
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-seqtk-with-a-single-or-handful-of-samples" class="md-nav__link">
    <span class="md-ellipsis">
      Running seqtk with a single (or handful) of samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-seqtk-with-a-list-of-files" class="md-nav__link">
    <span class="md-ellipsis">
      Running seqtk with a list of files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#downloading-and-updating-reference-databases" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading and updating reference databases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Downloading and updating reference databases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-andor-update-pr2-database" class="md-nav__link">
    <span class="md-ellipsis">
      Download and/or update pr2 database
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-nf-coreampliseq" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: nf-core/ampliseq
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: nf-core/ampliseq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#18s-primer-sequences-required" class="md-nav__link">
    <span class="md-ellipsis">
      18S primer sequences (required)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata-sheet-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata sheet (optional)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-samplesheet-sheet-for-ampliseq" class="md-nav__link">
    <span class="md-ellipsis">
      Create samplesheet sheet for ampliseq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-nf-coreampliseq-cutadapt-dada2" class="md-nav__link">
    <span class="md-ellipsis">
      Run nf-core/ampliseq (Cutadapt &amp; DADA2)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Run nf-core/ampliseq (Cutadapt & DADA2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files-generated-by-ampliseq" class="md-nav__link">
    <span class="md-ellipsis">
      Files generated by ampliseq
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/GMGI-Fisheries/resources/blob/master/docs/eDNA 18S metab/01-Metabarcoding ampliseq 18S.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="metabarcoding-workflow-for-18s-amplicon-sequencing">Metabarcoding workflow for 18S amplicon sequencing</h1>
<p>The 18S region contains many different regions to pick from for metabarcoding. The Ecosystem team at GMGI has optimized the 18S SSU set (18S-SSU-F04, 18S-SSU-R22) and the 18S-v8v9 set (18S-1422F, 18S-1797R). Due to better species coverage, the GMGI Ecosystem Team has switched over to using the v8v9 region for 18S.  </p>
<p>Citations:    <br />
- 18S-SSU-F04, 18S-SSU-R22 [Blaxter et al. 1998/Fonseca et al. 2010]     <br />
- 18S-1422F, 18S-1797R [Bradley et al. 2016]    </p>
<p><img alt="" src="https://www.cell.com/cms/10.1016/j.tree.2023.05.002/asset/299cb69d-eec4-420f-86a0-79579d929d9b/main.assets/b1_lrg.jpg" /></p>
<p>Analysis workflow:  <br />
1. Assess quality of fastq files using FASTQC and MultiQC<br />
2. Identify sequencing outliers and sub-sample if needed <br />
3. Run nf-core/ampliseq to remove adapters, predict ASVs, assign taxonomy, and generate counts tables    </p>
<h3 id="project-set-up">Project set-up</h3>
<p>Typical project folder structure (once analysis is run) for Fisheries team. Create <code>scripts</code>, <code>results</code> (for ampliseq output), <code>fastqc</code>, and <code>metadata</code>. E.g., <code>mkdir results</code>. </p>
<div class="highlight"><pre><span></span><code>fastqc  metadata  multiqc_raw_data  multiqc_raw.html  raw_data  results  scripts
</code></pre></div>
<p>Create/edit a slurm script: <code>nano name.sh</code>  <br />
View a file without editing: <code>less name.sh</code>  <br />
Start an interactive node: <code>srun --pty bash</code>    </p>
<h2 id="confirm-conda-environment-is-available">Confirm conda environment is available</h2>
<p>The conda environment is started within each slurm script, but to activate conda environment outside of the slurm script to update packages or check what is installed:</p>
<div class="highlight"><pre><span></span><code># Activate conda
source /projects/gmgi/miniconda3/bin/activate

# Activate fisheries eDNA conda environment 
conda activate fisheries_eDNA

# List all available environments 
conda env list 

# List all packages installed in fisheries_eDNA
conda list 

# Update a package
conda update [package name]

# Update nextflow ampliseq workflow 
nextflow pull nf-core/ampliseq
</code></pre></div>
<h2 id="assess-quality-of-raw-data">Assess quality of raw data</h2>
<p>Background information on <a href="https://hbctraining.github.io/Intro-to-rnaseq-hpc-salmon-flipped/lessons/05_qc_running_fastqc_interactively.html">FASTQC</a>. This should take ~10 seconds per file for a typical full MiSeq run. If &lt;2 seconds, then check output/error files.  </p>
<p>Create slurm script: <code>nano 01-fastqc.sh</code>. Copy below script into file and save (Ctrl+X; Y; Enter).</p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/fastqc_output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/fastqc_output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=20:00:00
#SBATCH --job-name=fastqc
#SBATCH --mem=3GB
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=2

### USER TO-DO ### 
## 1. Set paths for your project

# Activate conda environment
source /projects/gmgi/miniconda3/bin/activate fisheries_eDNA

## SET PATHS (USER EDITS)
raw_path=&quot;/projects/gmgi/example/18S/raw_data&quot;
out_dir=&quot;/projects/gmgi/example/18S/fastqc&quot;

## CREATE SAMPLE LIST FOR SLURM ARRAY
### 1. Create list of all .gz files in raw data path
ls -d ${raw_path}/*.gz &gt; ${raw_path}/rawdata

### 2. Create a list of filenames based on that list created in step 1
mapfile -t FILENAMES &lt; ${raw_path}/rawdata

### 3. Create variable i that will assign each row of FILENAMES to a task ID
i=${FILENAMES[$SLURM_ARRAY_TASK_ID]}

## RUN FASTQC PROGRAM 
fastqc ${i} --outdir ${out_dir}
</code></pre></div>
<p>To run:  <br />
- Start slurm array (e.g., with 138 files) = <code>sbatch --array=0-137 01-fastqc.sh</code>. <em>Note that this starts with file 0</em>. </p>
<p>Count the number of files by navigating to raw data folder and using <code>ls *.gz | wc</code>. The first column is the number of rows in the generated list (files). </p>
<p>Notes:  </p>
<ul>
<li>This is going to output <em>many</em> error and output files. After job completes, navigate to <code>cd scripts/output/fastqc_output</code> and use <code>cat *output.* &gt; ../fastqc_output.txt</code> to create one file with all the output and <code>cat *error.* &gt; ../fastqc_error.txt</code> to create one file with all of the error message outputs. </li>
<li>Within the <code>out_dir</code> output folder, use <code>ls *html | wc</code> to count the number of html output files (1st/2nd column values). This should be equal to the --array range used and the number of raw data files. If not, the script missed some input files so address this before moving on.  </li>
</ul>
<h3 id="visualize-quality-of-raw-data">Visualize quality of raw data</h3>
<p>Background information on <a href="https://multiqc.info/docs/#:~:text=MultiQC%20is%20a%20reporting%20tool%20that%20parses%20results,experiments%20containing%20multiple%20samples%20and%20multiple%20analysis%20steps">MULTIQC</a>.</p>
<p>Run the following code in an interactive node. This program will be quick for eDNA data (typically &lt;2 minutes).</p>
<div class="highlight"><pre><span></span><code># Use srun to claim a node
srun --pty bash 

# Activate conda environment
source /projects/gmgi/miniconda3/bin/activate fisheries_eDNA

## SET PATHS 
## fastqc_output = output from 00-fastqc.sh; fastqc program
fastqc_output=&quot;&quot; 
multiqc_dir=&quot;&quot; 

## RUN MULTIQC 
### Navigate to your project
multiqc --interactive ${fastqc_output} -o ${multiqc_dir} --filename multiqc_raw.html
</code></pre></div>
<p>Path examples:  <br />
- fastqc_output="/projects/gmgi/example/fastqc"   <br />
- multiqc_dir="/projects/gmgi/example" (goes in general folder)      </p>
<h2 id="identify-sequencing-outliers-and-sub-sample-if-needed">Identify sequencing outliers and sub-sample if needed</h2>
<p>This step can be done two ways: 1) download read counts from Illumina basespace run information or 2) Download read counts from the multiqc report. Either way, you need an excel file with the sample ID and total read count. </p>
<p>Read counts can be downloaded from the General Statistics section on Multiqc by selecting Export as CSV &gt; Data &gt; Format (csv) &gt; Download Plot Data. Save this file in the project repository. </p>
<p><img alt="" src="https://github.com/GMGI-Fisheries/resources/blob/master/img/Multiqc_reads_example_download2.png?raw=true" /></p>
<p>We use a median absolute deviation (MAD) approach that works by first finding the median of the data, then measuring how far each value deviates from that median and using the median of those deviations as the typical spread. Values whose deviation is much larger than this typical spread are flagged as outliers.</p>
<p>Visit this <a href="https://gmgi-fisheries.github.io/resources/eDNA%2012S%20metab/02-outlier_detection-template-12S/">page</a> for the R script or download <a href="https://github.com/GMGI-Fisheries/resources/blob/master/docs/eDNA%2012S%20metab/02-outlier_detection-template-12S.Rmd">here</a>.</p>
<h3 id="download-seqtk-program">Download seqtk program</h3>
<p>This program has already been installed on NU with the below code:</p>
<div class="highlight"><pre><span></span><code># move to gmgi/packages folder 
cd /projects/gmgi/packages/

# download seqtk program from their github page; move into that folder; and enable (`make`) the program
# ; indicates a pipe much like %&gt;% in R
git clone https://github.com/lh3/seqtk.git;
cd seqtk; make
</code></pre></div>
<p>Path to the program: <code>/projects/gmgi/packages/seqtk/seqtk</code></p>
<h3 id="running-seqtk-with-a-single-or-handful-of-samples">Running seqtk with a single (or handful) of samples</h3>
<p>Calculate the median number of reads prior to this code. This example will use 70,377. </p>
<div class="highlight"><pre><span></span><code># start an interactive session on 1 node
srun --pty bash 

# cd to your raw data folder
# make a new folder called outliers (`mkdir` = make directory)
mkdir outliers

# define a path to reference later using ${seqtk}
seqtk=&quot;/projects/gmgi/packages/seqtk/seqtk&quot;

# reference the program path above using ${} and subsample the original fastq file 
# to 70,377 reads using a set seed of -s100 following by gzipping that file using a pipe |
# that is similar to %&gt;% in R. I have two commands then: 1) sub-sample 2) gzip 
# &gt; indicates a new output file 

${seqtk} sample -s100 INS2-FS-0011_S284_L001_R1_001.fastq.gz 70377 | gzip &gt; INS2-FS-0011_S284_L001_R1_001_subset.fastq.gz
${seqtk} sample -s100 INS2-FS-0011_S284_L001_R2_001.fastq.gz 70377 | gzip &gt; INS2-FS-0011_S284_L001_R2_001_subset.fastq.gz

# move original files into the outliers folders so they are out of the way of our analysis 
mv INS2-FS-0011_S284_L001_R1_001.fastq.gz outliers/
mv INS2-FS-0011_S284_L001_R2_001.fastq.gz outliers/
</code></pre></div>
<h3 id="running-seqtk-with-a-list-of-files">Running seqtk with a list of files</h3>
<p>Create a samplesheet using <code>03a-metadata.R</code> below as an example. If you have a csv with 'sampleID', 'forwardReads', and 'reverseReads' columns then turn that csv into a text file with:</p>
<p><code>tail -n +2 outlier_list_for_subsampling.csv | cut -d',' -f2,3 | tr ',' '\n' &gt; outlier_paths.txt</code></p>
<p>The input to the below .sh is a txt file with a single column with no header that lists the full path of each fastq file to subset.</p>
<p><code>02-outlier.sh</code></p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=4:00:00
#SBATCH --job-name=02-outlier
#SBATCH --mem=1GB
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=1

### Running seqtk for a list of files

# path to seqtk
seqtk=&quot;/projects/gmgi/packages/seqtk/seqtk&quot;

# input list
input_list=&quot;/projects/gmgi/example/18S/outlier_paths.txt&quot;

# directory for subset files 
output_directory=&quot;/projects/gmgi/example/18S/raw_data&quot;

# directory to archive files
archive_directory=&quot;/projects/gmgi/oceanX/example/18S/raw_data/outliers&quot;

# number of reads
nreads=70377
seed=100

# Run seqtk on the input_list files
while read -r fq; do
    [[ -z &quot;$fq&quot; ]] &amp;&amp; continue

    base=$(basename &quot;$fq&quot; .fastq.gz)
    out=&quot;${output_directory}/${base}_subset.fastq.gz&quot;

    echo &quot;Subsampling: $fq -&gt; $out&quot;
    &quot;${seqtk}&quot; sample -s&quot;${seed}&quot; &quot;$fq&quot; &quot;${nreads}&quot; | gzip &gt; &quot;$out&quot;

done &lt; &quot;$input_list&quot;


# Move input_list files to the archive folder
mkdir -p &quot;$archive_directory&quot;

while read -r fq; do
    [[ -z &quot;$fq&quot; ]] &amp;&amp; continue

    echo &quot;Archiving: $fq -&gt; $archive_directory&quot;
    mv &quot;$fq&quot; &quot;$archive_directory/&quot;

done &lt; &quot;$input_list&quot;
</code></pre></div>
<h2 id="downloading-and-updating-reference-databases">Downloading and updating reference databases</h2>
<h3 id="download-andor-update-pr2-database">Download and/or update pr2 database</h3>
<p>[https://pr2-database.org/]</p>
<p>nf-core/ampliseq will download pr2 on its own, but see below website to confirm that the most recent version was indeed used in your workflow. After ampliseq, view the contents of this file:</p>
<p><code>/results/dada2/ref_taxonomy.pr2.txt</code></p>
<div class="highlight"><pre><span></span><code>--dada_ref_taxonomy: pr2

Title: PR2 - Protist Reference Ribosomal Database - Version 5.1.0

Citation: Guillou L, Bachar D, Audic S, Bass D, Berney C, Bittner L, Boutte C, Burgaud G, de Vargas C, Decelle J, Del Campo J, Dolan JR, Dunthorn M, Edvardsen B, Holzmann M, Kooistra WH, Lara E, Le Bescot N, Logares R, Mah F, Massana R, Montresor M, Morard R, Not F, Pawlowski J, Probert I, Sauvadet AL, Siano R, Stoeck T, Vaulot D, Zimmermann P, Christen R. The Protist Ribosomal Reference database (PR2): a catalog of unicellular eukaryote small sub-unit rRNA sequences with curated taxonomy. Nucleic Acids Res. 2013 Jan;41(Database issue):D597-604. doi: 10.1093/nar/gks1160. Epub 2012 Nov 27. PMID: 23193267; PMCID: PMC3531120.

All entries: [title:PR2 - Protist Reference Ribosomal Database - Version 5.1.0, file:[https://github.com/pr2database/pr2database/releases/download/v5.1.0.0/pr2_version_5.1.0_SSU_dada2.fasta.gz, https://github.com/pr2database/pr2database/releases/download/v5.1.0.0/pr2_version_5.1.0_SSU_UTAX.fasta.gz], citation:Guillou L, Bachar D, Audic S, Bass D, Berney C, Bittner L, Boutte C, Burgaud G, de Vargas C, Decelle J, Del Campo J, Dolan JR, Dunthorn M, Edvardsen B, Holzmann M, Kooistra WH, Lara E, Le Bescot N, Logares R, Mah F, Massana R, Montresor M, Morard R, Not F, Pawlowski J, Probert I, Sauvadet AL, Siano R, Stoeck T, Vaulot D, Zimmermann P, Christen R. The Protist Ribosomal Reference database (PR2): a catalog of unicellular eukaryote small sub-unit rRNA sequences with curated taxonomy. Nucleic Acids Res. 2013 Jan;41(Database issue):D597-604. doi: 10.1093/nar/gks1160. Epub 2012 Nov 27. PMID: 23193267; PMCID: PMC3531120., fmtscript:taxref_reformat_pr2.sh, dbversion:PR2 v5.1.0 (https://github.com/pr2database/pr2database/releases/tag/v5.1.0.0), taxlevels:Domain,Supergroup,Division,Subdivision,Class,Order,Family,Genus,Species]
</code></pre></div>
<h2 id="step-4-nf-coreampliseq">Step 4: nf-core/ampliseq</h2>
<p><a href="https://nf-co.re/">Nf-core</a>: A community effort to collect a curated set of analysis pipelines built using <a href="https://www.nextflow.io/">Nextflow</a>.<br />
Nextflow: scalable and reproducible scientific workflows using software containers, used to build wrapper programs like the one we use here.  </p>
<p>[https://nf-co.re/ampliseq/2.11.0]: nfcore/ampliseq is a bioinformatics analysis pipeline used for amplicon sequencing, supporting denoising of any amplicon and supports a variety of taxonomic databases for taxonomic assignment including 16S, ITS, CO1 and 18S. </p>
<p><img alt="" src="https://raw.githubusercontent.com/nf-core/ampliseq/2.11.0//docs/images/ampliseq_workflow.png" /></p>
<p>We use ampliseq for the following programs:  </p>
<ul>
<li><a href="https://journal.embnet.org/index.php/embnetjournal/article/view/200">Cutadapt</a> is trimming primer sequences from sequencing reads. Primer sequences are non-biological sequences that often introduce point mutations that do not reflect sample sequences. This is especially true for degenerated PCR primer. If primer trimming would be omitted, artifactual amplicon sequence variants might be computed by the denoising tool or sequences might be lost due to become labelled as PCR chimera.  </li>
<li><a href="https://www.nature.com/articles/nmeth.3869">DADA2</a> performs fast and accurate sample inference from amplicon data with single-nucleotide resolution. It infers exact amplicon sequence variants (ASVs) from amplicon data with fewer false positives than many other methods while maintaining high sensitivity. This program also assigns taxonomy using a RDP classifier.    </li>
</ul>
<h3 id="18s-primer-sequences-required">18S primer sequences (required)</h3>
<p>Below is what we used for 18S amplicon sequencing. Ampliseq will automatically calculate the reverse compliment and include this for us. Copy the capitalized primer region to place inside the ampliseq script. </p>
<p>Format: lower_case_adapter UPPER_CASE_PRIMER_SEQUENCE</p>
<p>FO4+R22 (Blaxter et al. 1998/Fonseca et al. 2010)<br />
- 18S-SSU-FO4_Illumina (54 bases): tcgtcggcagcgtcagatgtgtataagagacag GCTTGTCTCAAAGATTAAGCC  <br />
- 18S-SSU-R22_Illumina (53 bases): gtctcgtgggctcggagatgtgtataagagacag GCCTGCTGCCTTCCTTGGA   </p>
<p>v8v9 (Bradley et al. 2016)<br />
- 18S_1422F_illumina (54 bases): tcgtcggcagcgtcagatgtgtataagagacag ATAACAGGTCTGTGATGCCCT  <br />
- 18S_1797R_illumina (53 bases): gtctcgtgggctcggagatgtgtataagagacag CTTCYGCAGGTTCACCTAC    </p>
<h3 id="metadata-sheet-optional">Metadata sheet (optional)</h3>
<p>The metadata file has to follow the <a href="https://docs.qiime2.org/2021.2/tutorials/metadata/">QIIME2 specifications</a>. Below is a preview of the sample sheet used for this test. Keep the column headers the same for future use. The first column needs to be "ID" and can only contain numbers, letters, or "-". This is different than the sample sheet. NAs should be empty cells rather than "NA". </p>
<h3 id="create-samplesheet-sheet-for-ampliseq">Create samplesheet sheet for ampliseq</h3>
<p>This file indicates the sample ID and the path to R1 and R2 files. Below is a preview of the sample sheet used in this test. File created on RStudio Interactive on Discovery Cluster using (<code>create_metadatasheets.R</code>).  </p>
<ul>
<li>sampleID (required): Unique sample IDs, must start with a letter, and can only contain letters, numbers or underscores (no hyphons!).  </li>
<li>forwardReads (required): Paths to (forward) reads zipped FastQ files  </li>
<li>reverseReads (optional): Paths to reverse reads zipped FastQ files, required if the data is paired-end  </li>
<li>run (optional): If the data was produced by multiple sequencing runs, any string  </li>
</ul>
<table>
<thead>
<tr>
<th>sampleID</th>
<th>forwardReads</th>
<th>reverseReads</th>
<th>run</th>
</tr>
</thead>
<tbody>
<tr>
<td>sample1</td>
<td>./data/S1_R1_001.fastq.gz</td>
<td>./data/S1_R2_001.fastq.gz</td>
<td>A</td>
</tr>
<tr>
<td>sample2</td>
<td>./data/S2_fw.fastq.gz</td>
<td>./data/S2_rv.fastq.gz</td>
<td>A</td>
</tr>
<tr>
<td>sample3</td>
<td>./S4x.fastq.gz</td>
<td>./S4y.fastq.gz</td>
<td>B</td>
</tr>
<tr>
<td>sample4</td>
<td>./a.fastq.gz</td>
<td>./b.fastq.gz</td>
<td>B</td>
</tr>
</tbody>
</table>
<p><em>This is an R script, not slurm script. Open RStudio interactive on Discovery Cluster to run this script.</em></p>
<p>Prior to running R script, use the <code>rawdata</code> file created for the fastqc slurm array from within the raw data folder to create a list of files. Below is an example from our Offshore Wind project but the specifics of the sampleID will be project dependent. This project had four sequencing runs with different file names. </p>
<p>On OOD, open RStudio. Create a new R script file:</p>
<p><code>03-metadata.R</code></p>
<div class="highlight"><pre><span></span><code>## Creating ampliseq metadata sheet for GOBLER
## Load libraries 
library(dplyr)
library(stringr)
library(strex) 

### Read in sample sheet 
sample_list &lt;- read.delim2(&quot;/projects/gmgi/example/16S/raw_data/rawdata&quot;, header=F) %&gt;% 
  dplyr::rename(forwardReads = V1) %&gt;%
  mutate(sampleID = str_after_nth(forwardReads, &quot;data/&quot;, 1),

         ### Confirm that _S is correct for your file names, sometimes this is _R
         sampleID = str_before_nth(sampleID, &quot;_S&quot;, 1))

         ## add any other mutate functions as needed for sample names
         ## sampleID needs to match a column in your metadata file for later analyses 

# creating sample ID 
sample_list$sampleID &lt;- gsub(&quot;-&quot;, &quot;_&quot;, sample_list$sampleID)

# keeping only rows with R1
sample_list &lt;- filter(sample_list, grepl(&quot;R1&quot;, forwardReads, ignore.case = TRUE))

# duplicating column 
sample_list$reverseReads &lt;- sample_list$forwardReads

# replacing R1 with R2 in only one column 
sample_list$reverseReads &lt;- gsub(&quot;R1&quot;, &quot;R2&quot;, sample_list$reverseReads)

# rearranging columns 
sample_list &lt;- sample_list[,c(2,1,3)]

sample_list %&gt;% write.csv(&quot;/projects/gmgi/example/16S/metadata/samplesheet.csv&quot;, 
                          row.names=FALSE, quote = FALSE)
</code></pre></div>
<h3 id="run-nf-coreampliseq-cutadapt-dada2">Run nf-core/ampliseq (Cutadapt &amp; DADA2)</h3>
<p>Update ampliseq workflow if needed: <code>nextflow pull nf-core/ampliseq</code>. </p>
<p>Create slurm script: <code>nano 04-ampliseq.sh</code>. Copy below script into file and save (Ctrl+X; Y; Enter). You'll notice that <code>/projects/gmgi/Fisheries/scripts/  ampliseq_minBoot.config</code> is used as a custom config file. This file will set minBoot=80 instead of 50 to reflect a more conservative taxonomic assignment. </p>
<p>Set <code>trunclenf</code> and <code>trunclenr</code> based on data quality. Set job name as desired, I use the format <code>ampliseq_&lt;project&gt;_&lt;marker&gt;</code>. Our in-house MiSeq i100 data has been extremely high quality and 250 could be used for trimming. </p>
<p>Either <code>pr2</code> or <code>pr2=&lt;v#&gt;</code> can be used in the ref taxonomy flag. Ensure the most recent version of pr2 is being used. </p>
<p><em><code>skip_summary_report_fastqc</code> is being used right now because this version of ampliseq has a bug in the summary report creation step.</em> </p>
<p><code>04-ampliseq_16S.sh</code>: </p>
<div class="highlight"><pre><span></span><code>#!/bin/bash
#SBATCH --error=output/&quot;%x_error.%j&quot; #if your job fails, the error report will be put in this file
#SBATCH --output=output/&quot;%x_output.%j&quot; #once your job is completed, any final job report comments will be put in this file
#SBATCH --partition=short
#SBATCH --nodes=1
#SBATCH --time=48:00:00
#SBATCH --job-name=ampliseq_project_marker
#SBATCH --mem=70GB
#SBATCH --ntasks=12
#SBATCH --cpus-per-task=2

### USER TO-DO ### 
## 1. Set paths for project 
## 2. Adjust SBATCH options above (time, mem, ntasks, etc.) as desired  
## 3. Fill in F and R primer information based on primer type (no reverse compliment needed)
## 4. Adjust parameters as needed (below is Fisheries team default for 18S)

# Load nextflow conda environment
source /projects/gmgi/miniconda3/bin/activate nextflow_env

# SET PATHS 
metadata=&quot;/projects/gmgi/example/18S/metadata&quot; 
output_dir=&quot;/projects/gmgi/example/18S/results&quot;
taxlevels=&quot;Domain,Supergroup,Division,Subdivision,Class,Order,Family,Genus,Species&quot;

nextflow run nf-core/ampliseq -resume \
   -c /projects/gmgi/Fisheries/scripts/ampliseq_minBoot.config \
   -profile singularity \
   --input ${metadata}/samplesheet.csv \
   --FW_primer &quot;&quot; \
   --RV_primer &quot;&quot; \
   --outdir ${output_dir} \
   --trunclenf 240 \
   --trunclenr 240 \
   --max_ee 2 \
   --sample_inference pseudo \
   --ignore_failed_trimming \
   --ignore_empty_input_files \
   --dada_ref_taxonomy pr2 \
   --dada_assign_taxlevels ${taxlevels} \
   --skip_summary_report_fastqc true
</code></pre></div>
<p>To run: <br />
- <code>sbatch 04-ampliseq.sh</code> </p>
<h4 id="files-generated-by-ampliseq">Files generated by ampliseq</h4>
<p>Pipeline summary reports:  </p>
<ul>
<li><code>summary_report/</code></li>
<li><code>summary_report.html</code>: pipeline summary report as standalone HTML file that can be viewed in your web browser.</li>
<li><code>*.svg*</code>: plots that were produced for (and are included in) the report.</li>
<li><code>versions.yml</code>: software versions used to produce this report.</li>
</ul>
<p>Preprocessing:  </p>
<ul>
<li>FastQC: <code>fastqc/</code> and <code>*_fastqc.html</code>: FastQC report containing quality metrics for your untrimmed raw fastq files.  </li>
<li>Cutadapt: <code>cutadapt/</code> and <code>cutadapt_summary.tsv</code>: summary of read numbers that pass cutadapt  </li>
<li>MultiQC: <code>multiqc</code>, <code>multiqc_data/</code>, <code>multiqc_plots/</code> with <code>multiqc_report.html</code>: a standalone HTML file that can be viewed in your web browser; </li>
</ul>
<p>ASV inferrence with DADA2:  </p>
<ul>
<li><code>dada2/</code>, <code>dada2/args/</code>, <code>data2/log/</code> </li>
<li><code>ASV_seqs.fasta</code>: Fasta file with ASV sequences.</li>
<li><code>ASV_table.tsv</code>: Counts for each ASV sequence.</li>
<li><code>DADA2_stats.tsv</code>: Tracking read numbers through DADA2 processing steps, for each sample.</li>
<li><code>DADA2_table.rds</code>: DADA2 ASV table as R object.</li>
<li><code>DADA2_table.tsv</code>: DADA2 ASV table.  </li>
<li><code>dada2/QC/</code></li>
<li><code>*.err.convergence.txt</code>: Convergence values for DADA2's dada command, should reduce over several magnitudes and approaching 0.  </li>
<li><code>*.err.pdf</code>: Estimated error rates for each possible transition. The black line shows the estimated error rates after convergence of the machine-learning algorithm. The red line shows the error rates expected under the nominal definition of the Q-score. The estimated error rates (black line) should be a good fit to the observed rates (points), and the error rates should drop with increased quality.  </li>
<li><code>*_qual_stats.pdf</code>: Overall read quality profiles: heat map of the frequency of each quality score at each base position. The mean quality score at each position is shown by the green line, and the quartiles of the quality score distribution by the orange lines. The red line shows the scaled proportion of reads that extend to at least that position.  </li>
<li><code>*_preprocessed_qual_stats.pdf</code>: Same as above, but after preprocessing.  </li>
</ul>
<p>We add an ASV length filter that will output <code>asv_length_filter/</code> with:  </p>
<ul>
<li><code>ASV_seqs.len.fasta</code>: Fasta file with filtered ASV sequences.  </li>
<li><code>ASV_table.len.tsv</code>: Counts for each filtered ASV sequence.  </li>
<li><code>ASV_len_orig.tsv</code>: ASV length distribution before filtering.  </li>
<li><code>ASV_len_filt.tsv</code>: ASV length distribution after filtering.  </li>
<li><code>stats.len.tsv</code>: Tracking read numbers through filtering, for each sample.  </li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
    
  </body>
</html>