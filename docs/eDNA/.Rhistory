plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Raw reads (%)") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_percent_rawreads.png", width=3, height=3)
results <- read_xlsx("example_output/Results_rawreads_long.xlsx") %>%
## calculate sum of reads
group_by(sampleID) %>%
mutate(`Number of reads` = sum(reads)) %>%
## calculate relative abundance
group_by(sampleID, Species_name) %>%
mutate(`Relative Abundance` = reads/`Number of reads`) %>%
mutate(Category = factor(levels = c(
"Human", "Livestock", "Other", "Unassigned", "Bird", "Elasmobranch", "Marine Mammal", "Sea Turtle",
"Teleost Fish"
)))
results <- read_xlsx("example_output/Results_rawreads_long.xlsx") %>%
## calculate sum of reads
group_by(sampleID) %>%
mutate(`Number of reads` = sum(reads)) %>%
## calculate relative abundance
group_by(sampleID, Species_name) %>%
mutate(`Relative Abundance` = reads/`Number of reads`)
fill_colors <- c(
"Bird" = "#f0f3bd",
"Elasmobranch" = "#02c39a",
"Human" = "#e26d5c",
"Livestock" = "#deab90",
"Marine Mammal" = "#52b69a",
"Other" = "#ff9b54",
"Sea Turtle" = "#90e0ef",
"Teleost Fish" = "#00b4d8",
"Unassigned" = "#f3722c"
)
results %>% group_by(sampleID, Category) %>%
summarise(group_sum = sum(reads),
group_relab = group_sum/`Number of reads`
) %>% distinct() %>%
ggplot(., aes(y=group_relab, x=Category)) +
geom_boxplot(outlier.shape = NA, aes(color=Category), fill=NA) +
geom_jitter(aes(fill=Category), width=0.2, shape=21, color='black', size = 0.75, alpha=0.35) +
scale_color_manual(values = fill_colors) +
scale_fill_manual(values = fill_colors) +
labs(color = "Category") +
theme_bw() +
xlab("Category") + ylab("Relative abundance") +
theme(panel.background=element_rect(fill='white', colour='black'),
legend.position = "none",
axis.text.y = element_text(size=7, color="grey30"),
axis.text.x = element_text(size=7, angle=45, hjust=1),
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size=11, face="bold"),
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size=11, face="bold"))
ggsave("example_output/Figures/Categories_relative_abundance.png", width = 5, height = 4)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart <- general_stats %>%
mutate(csum = rev(cumsum(rev(percent))),
pos = percent/2 + lead(csum, 1),
pos = if_else(is.na(pos), percent/2, pos))
piechart_reads <- general_stats %>%
ggplot(., aes(x="", y = percent, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart,
aes(y = pos, label = paste0(percent, "%")),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Raw reads (%)") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_percent_rawreads.png", width=3, height=3)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart_ASV <- ASV_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_ASV <- ASV_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_ASV,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Number of ASVs") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_ASVs.png", width=3, height=3)
piechart_spp <- species_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_species_plot <- species_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_spp,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank()     # Remove axis titles
) +
ggtitle("Number of species") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_species.png", width=4, height=3)
fill_colors <- c(
"Bird" = "#d9ed92",
"Elasmobranch" = "#99d98c",
"Human" = "#76c893",
"Livestock" = "#52b69a",
"Marine Mammal" = "#34a0a4",
"Other" = "#48bfe3",
"Sea Turtle" = "#4ea8de",
"Teleost Fish" = "#bdb2ff",
"Unassigned" = "#ffddd2"
)
results %>% group_by(sampleID, Category) %>%
summarise(group_sum = sum(reads),
group_relab = group_sum/`Number of reads`
) %>% distinct() %>%
ggplot(., aes(y=group_relab, x=Category)) +
geom_boxplot(outlier.shape = NA, aes(color=Category), fill=NA) +
geom_jitter(aes(fill=Category), width=0.2, shape=21, color='black', size = 0.75, alpha=0.35) +
scale_color_manual(values = fill_colors) +
scale_fill_manual(values = fill_colors) +
labs(color = "Category") +
theme_bw() +
xlab("Category") + ylab("Relative abundance") +
theme(panel.background=element_rect(fill='white', colour='black'),
legend.position = "none",
axis.text.y = element_text(size=7, color="grey30"),
axis.text.x = element_text(size=7, angle=45, hjust=1),
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size=11, face="bold"),
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size=11, face="bold"))
ggsave("example_output/Figures/Categories_relative_abundance.png", width = 5, height = 4)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart <- general_stats %>%
mutate(csum = rev(cumsum(rev(percent))),
pos = percent/2 + lead(csum, 1),
pos = if_else(is.na(pos), percent/2, pos))
piechart_reads <- general_stats %>%
ggplot(., aes(x="", y = percent, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart,
aes(y = pos, label = paste0(percent, "%")),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Raw reads (%)") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_percent_rawreads.png", width=3, height=3)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart_ASV <- ASV_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_ASV <- ASV_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_ASV,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Number of ASVs") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_ASVs.png", width=3, height=3)
piechart_spp <- species_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_species_plot <- species_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_spp,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank()     # Remove axis titles
) +
ggtitle("Number of species") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_species.png", width=4, height=3)
fill_colors <- c(
"Bird" = "#d9ed92",
"Elasmobranch" = "#99d98c",
"Human" = "#76c893",
"Livestock" = "#f3722c",
"Marine Mammal" = "#34a0a4",
"Other" = "#ee9b00",
"Sea Turtle" = "#90e0ef",
"Teleost Fish" = "#00b4d8",
"Unassigned" = "#ffddd2"
)
results %>% group_by(sampleID, Category) %>%
summarise(group_sum = sum(reads),
group_relab = group_sum/`Number of reads`
) %>% distinct() %>%
ggplot(., aes(y=group_relab, x=Category)) +
geom_boxplot(outlier.shape = NA, aes(color=Category), fill=NA) +
geom_jitter(aes(fill=Category), width=0.2, shape=21, color='black', size = 0.75, alpha=0.35) +
scale_color_manual(values = fill_colors) +
scale_fill_manual(values = fill_colors) +
labs(color = "Category") +
theme_bw() +
xlab("Category") + ylab("Relative abundance") +
theme(panel.background=element_rect(fill='white', colour='black'),
legend.position = "none",
axis.text.y = element_text(size=7, color="grey30"),
axis.text.x = element_text(size=7, angle=45, hjust=1),
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size=11, face="bold"),
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size=11, face="bold"))
ggsave("example_output/Figures/Categories_relative_abundance.png", width = 5, height = 4)
fill_colors <- c(
"Bird" = "#d9ed92",
"Elasmobranch" = "#99d98c",
"Human" = "#76c893",
"Livestock" = "#f3722c",
"Marine Mammal" = "#34a0a4",
"Other" = "#ee9b00",
"Sea Turtle" = "#90e0ef",
"Teleost Fish" = "#00b4d8",
"Unassigned" = "#ffddd2"
)
results %>% group_by(sampleID, Category) %>%
summarise(group_sum = sum(reads),
group_relab = group_sum/`Number of reads`
) %>% distinct() %>%
ggplot(., aes(y=group_relab, x=Category)) +
geom_boxplot(outlier.shape = NA, aes(color=Category), fill=NA) +
geom_jitter(aes(fill=Category), width=0.2, shape=21, color='black', size = 0.75, alpha=0.35) +
scale_color_manual(values = fill_colors) +
scale_fill_manual(values = fill_colors) +
labs(color = "Category") +
theme_bw() +
xlab("Category") + ylab("Relative abundance") +
theme(panel.background=element_rect(fill='white', colour='black'),
legend.position = "none",
axis.text.y = element_text(size=7, color="grey30"),
axis.text.x = element_text(size=7, angle=45, hjust=1),
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size=11, face="bold"),
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size=11, face="bold"))
ggsave("example_output/Figures/Categories_relative_abundance.png", width = 5, height = 4)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart <- general_stats %>%
mutate(csum = rev(cumsum(rev(percent))),
pos = percent/2 + lead(csum, 1),
pos = if_else(is.na(pos), percent/2, pos))
piechart_reads <- general_stats %>%
ggplot(., aes(x="", y = percent, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart,
aes(y = pos, label = paste0(percent, "%")),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Raw reads (%)") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_percent_rawreads.png", width=3, height=3)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart_ASV <- ASV_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_ASV <- ASV_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_ASV,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Number of ASVs") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_ASVs.png", width=3, height=3)
piechart_spp <- species_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_species_plot <- species_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_spp,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank()     # Remove axis titles
) +
ggtitle("Number of species") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_species.png", width=4, height=3)
fill_colors <- c(
"Bird" = "#d9ed92",
"Elasmobranch" = "#99d98c",
"Human" = "#e56b6f",
"Livestock" = "#f3722c",
"Marine Mammal" = "#34a0a4",
"Other" = "#ee9b00",
"Sea Turtle" = "#90e0ef",
"Teleost Fish" = "#00b4d8",
"Unassigned" = "#ffddd2"
)
results %>% group_by(sampleID, Category) %>%
summarise(group_sum = sum(reads),
group_relab = group_sum/`Number of reads`
) %>% distinct() %>%
ggplot(., aes(y=group_relab, x=Category)) +
geom_boxplot(outlier.shape = NA, aes(color=Category), fill=NA) +
geom_jitter(aes(fill=Category), width=0.2, shape=21, color='black', size = 0.75, alpha=0.35) +
scale_color_manual(values = fill_colors) +
scale_fill_manual(values = fill_colors) +
labs(color = "Category") +
theme_bw() +
xlab("Category") + ylab("Relative abundance") +
theme(panel.background=element_rect(fill='white', colour='black'),
legend.position = "none",
axis.text.y = element_text(size=7, color="grey30"),
axis.text.x = element_text(size=7, angle=45, hjust=1),
axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0), size=11, face="bold"),
axis.title.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0), size=11, face="bold"))
ggsave("example_output/Figures/Categories_relative_abundance.png", width = 5, height = 4)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart <- general_stats %>%
mutate(csum = rev(cumsum(rev(percent))),
pos = percent/2 + lead(csum, 1),
pos = if_else(is.na(pos), percent/2, pos))
piechart_reads <- general_stats %>%
ggplot(., aes(x="", y = percent, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart,
aes(y = pos, label = paste0(percent, "%")),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Raw reads (%)") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_percent_rawreads.png", width=3, height=3)
### User edits:
### 1. Change paths of output to desired folder (data/figures is suggested data structure)
### 2. Change scale brewer color if desired
piechart_ASV <- ASV_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_ASV <- ASV_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_ASV,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank(),     # Remove axis titles
legend.position = "none"
) +
ggtitle("Number of ASVs") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_ASVs.png", width=3, height=3)
piechart_spp <- species_summary %>%
mutate(csum = rev(cumsum(rev(count))),
pos = count/2 + lead(csum, 1),
pos = if_else(is.na(pos), count/2, pos))
piechart_species_plot <- species_summary %>%
ggplot(., aes(x="", y = count, fill = Category)) +
geom_col(color = "black", width=1.25) +
geom_label_repel(data = piechart_spp,
aes(y = pos, label = paste0(count)),
size = 3, nudge_x = 1, show.legend = FALSE) +
coord_polar(theta = "y") +
scale_fill_manual(values = fill_colors) +
theme_bw() +
theme(
plot.background = element_rect(fill = "white", colour = NA),
plot.margin = margin(t = 5, r = 5, b = 5, l = 5, unit = "pt"),
panel.border = element_blank(),  # Remove panel border
panel.grid = element_blank(),    # Remove grid lines
axis.ticks = element_blank(),    # Remove axis ticks
axis.text = element_blank(),     # Remove axis text
axis.title = element_blank()     # Remove axis titles
) +
ggtitle("Number of species") +
xlab("") + ylab("") + labs(fill = "Category")
ggsave("example_output/Figures/Category_breakdown_species.png", width=4, height=3)
